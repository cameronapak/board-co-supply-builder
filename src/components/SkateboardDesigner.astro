---
import SkateboardTemplate from "@/components/SkateboardTemplate.astro";
---

<div x-data="skateboardDesigner">
  <div class="relative h-[512px] w-fit overflow-hidden rounded-t-full rounded-b-full" style="aspect-ratio: 428/1741;">
    <SkateboardTemplate class="pointer-events-none absolute top-0 right-0 bottom-0 left-0 z-20 h-full w-full" />
    <img
      x-show="imageUrl"
      :src="imageUrl"
      alt="Uploaded skateboard design"
      class="absolute top-0 right-0 bottom-0 left-0 z-10 h-full w-full object-cover"
    />
  </div>

  <input type="file" accept="image/*" @change="handleFileChange($event)" />
</div>

<script>
  import Alpine from "alpinejs";

  document.addEventListener("alpine:init", () => {
    Alpine.data("skateboardDesigner", function () {
      return {
        imageUrl: "",
        handleFileChange(event: Event) {
          const file = (event.target as HTMLInputElement).files?.[0];
          if (!file) {
            return;
          }

          const reader = new FileReader();
          reader.onload = (e) => {
            this.imageUrl = e.target?.result as string;
          };
          reader.readAsDataURL(file);
        }
      };
    });
  });
</script>
